version: '3'
services:
  postgresql:
    image: postgres:latest
    restart: always
    ports: 
      - "${PG_PORT}:5432"
    environment:
      - "POSTGRES_USER=postgres"
      - "POSTGRES_PASSWORD=password"
      - "POSTGRES_DB=rappidb"
    volumes: 
      - ${DBDATA_DIR}:/var/lib/postgresql/data
  users:
    image: "node:latest"
    restart: always
    ports:
      - "${USERS_PORT}:3000"
    environment:
      - "DB_NAME=rappidb"
      - "DB_USER=postgres"
      - "DB_PASS=password"
      - "DB_HOST=postgresql"
    volumes:
      - "${USERS_DIR}:/Code/users"
    entrypoint: ["sleep", "10000"]
    working_dir: /Code/users
  
  shops:
    image: node:latest
    restart: always
    ports: 
      - "${SHOPS_PORT}:3000"
    environment:
      - "DB_NAME=rappidb"
      - "DB_USER=postgres"
      - "DB_PASS=password"
      - "DB_HOST=postgresql"
    volumes:
      - "${SHOPS_DIR}:/Code/shops"
    entrypoint: ["sleep", "10000"]
    working_dir: /Code/shops



